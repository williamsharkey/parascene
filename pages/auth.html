<!doctype html>
<html lang="en">

<head>
	<title>parascene - auth</title>
	<link rel="stylesheet" href="/pages/auth.css" />
</head>

<body>
	<main>
		<div class="auth-logo">
			<a href="/" class="auth-logo-link">
				<!--
				<svg class="logo" width="300" height="60" viewBox="0 0 185 40">
					<text x="1" y="30" class="logo-text">
						<tspan opacity="1">par</tspan>
						<tspan opacity="0.7" dx="-7">asc</tspan>
						<tspan opacity="1" dx="-7">ene</tspan>
					</text>
				</svg>
				-->
				<svg class="logo" width="300" height="60" viewBox="0 0 185 40">
					<g class="logo-text">
					<path style="opacity: 1;" d="M 4.201 36.305 L 8.683 9.305 L 13.869 9.305 L 13.271 12.609 L 13.429 12.609 Q 13.922 11.801 14.721 10.975 Q 15.521 10.148 16.699 9.603 Q 17.877 9.059 19.459 9.059 Q 21.41 9.059 22.93 9.929 Q 24.451 10.799 25.339 12.53 Q 26.226 14.262 26.226 16.828 Q 26.226 18.937 25.637 21.126 Q 25.048 23.314 23.862 25.16 Q 22.675 27.006 20.882 28.148 Q 19.089 29.291 16.664 29.291 Q 14.994 29.291 13.93 28.711 Q 12.867 28.131 12.287 27.287 Q 11.707 26.443 11.461 25.652 L 11.214 25.652 L 9.474 36.305 Z M 15.17 25.055 Q 16.629 25.055 17.701 24.281 Q 18.773 23.508 19.476 22.295 Q 20.179 21.082 20.513 19.711 Q 20.847 18.34 20.847 17.127 Q 20.847 15.369 20.074 14.323 Q 19.3 13.277 17.683 13.277 Q 16.277 13.277 15.214 13.989 Q 14.15 14.701 13.438 15.87 Q 12.726 17.039 12.357 18.419 Q 11.988 19.799 11.988 21.152 Q 11.988 22.963 12.797 24.009 Q 13.605 25.055 15.17 25.055 Z M 34.036 29.291 Q 31.786 29.291 30.16 28.113 Q 28.534 26.936 27.848 24.677 Q 27.163 22.418 27.708 19.148 Q 28.27 15.791 29.729 13.55 Q 31.188 11.309 33.192 10.184 Q 35.196 9.059 37.376 9.059 Q 39.046 9.059 40.056 9.612 Q 41.067 10.166 41.612 10.992 Q 42.157 11.818 42.386 12.609 L 42.561 12.609 L 43.106 9.305 L 48.362 9.305 L 45.11 28.957 L 39.925 28.957 L 40.434 25.811 L 40.188 25.811 Q 39.678 26.619 38.852 27.419 Q 38.026 28.219 36.831 28.755 Q 35.636 29.291 34.036 29.291 Z M 36.374 25.055 Q 37.727 25.055 38.791 24.308 Q 39.854 23.561 40.575 22.233 Q 41.296 20.906 41.577 19.148 Q 41.876 17.355 41.603 16.037 Q 41.331 14.719 40.505 13.998 Q 39.678 13.277 38.325 13.277 Q 36.936 13.277 35.864 14.033 Q 34.792 14.789 34.097 16.107 Q 33.403 17.426 33.122 19.148 Q 32.841 20.871 33.104 22.207 Q 33.368 23.543 34.185 24.299 Q 35.003 25.055 36.374 25.055 Z M 48.344 28.957 L 51.596 9.305 L 56.694 9.305 L 56.149 12.732 L 56.36 12.732 Q 57.186 10.904 58.61 9.973 Q 60.034 9.041 61.686 9.041 Q 62.108 9.041 62.565 9.085 Q 63.022 9.129 63.373 9.217 L 62.582 13.928 Q 62.231 13.805 61.572 13.734 Q 60.913 13.664 60.35 13.664 Q 59.137 13.664 58.1 14.183 Q 57.063 14.701 56.369 15.624 Q 55.674 16.547 55.463 17.777 L 53.618 28.957 Z"></path>
					<path style="opacity: 0.7;" d="M 68.879 29.291 Q 66.629 29.291 65.003 28.113 Q 63.377 26.936 62.691 24.677 Q 62.006 22.418 62.551 19.148 Q 63.113 15.791 64.572 13.55 Q 66.031 11.309 68.035 10.184 Q 70.039 9.059 72.219 9.059 Q 73.888 9.059 74.899 9.612 Q 75.91 10.166 76.455 10.992 Q 77 11.818 77.228 12.609 L 77.404 12.609 L 77.949 9.305 L 83.205 9.305 L 79.953 28.957 L 74.767 28.957 L 75.277 25.811 L 75.031 25.811 Q 74.521 26.619 73.695 27.419 Q 72.869 28.219 71.674 28.755 Q 70.478 29.291 68.879 29.291 Z M 71.217 25.055 Q 72.57 25.055 73.634 24.308 Q 74.697 23.561 75.418 22.233 Q 76.138 20.906 76.42 19.148 Q 76.719 17.355 76.446 16.037 Q 76.174 14.719 75.347 13.998 Q 74.521 13.277 73.168 13.277 Q 71.779 13.277 70.707 14.033 Q 69.635 14.789 68.94 16.107 Q 68.246 17.426 67.965 19.148 Q 67.683 20.871 67.947 22.207 Q 68.211 23.543 69.028 24.299 Q 69.845 25.055 71.217 25.055 Z M 91.165 29.344 Q 88.792 29.344 87.035 28.649 Q 85.277 27.955 84.301 26.689 Q 83.326 25.424 83.22 23.684 Q 83.22 23.596 83.211 23.534 Q 83.203 23.473 83.203 23.42 L 88.142 22.91 Q 88.283 24.281 89.047 24.879 Q 89.812 25.477 91.412 25.477 Q 92.378 25.477 93.24 25.213 Q 94.101 24.949 94.672 24.448 Q 95.244 23.947 95.314 23.227 Q 95.367 22.559 94.883 22.102 Q 94.4 21.645 93.222 21.398 L 89.953 20.695 Q 87.386 20.15 86.156 18.77 Q 84.925 17.391 85.083 15.369 Q 85.207 13.33 86.455 11.924 Q 87.703 10.518 89.698 9.788 Q 91.693 9.059 94.048 9.059 Q 97.511 9.059 99.401 10.447 Q 101.29 11.836 101.537 14.086 Q 101.572 14.191 101.589 14.279 Q 101.607 14.367 101.607 14.473 L 96.914 14.947 Q 96.773 13.945 96.123 13.392 Q 95.472 12.838 94.066 12.838 Q 93.205 12.838 92.378 13.102 Q 91.552 13.365 90.99 13.857 Q 90.427 14.35 90.357 15.088 Q 90.287 15.756 90.744 16.195 Q 91.201 16.635 92.431 16.916 L 95.841 17.619 Q 98.425 18.146 99.665 19.43 Q 100.904 20.713 100.746 22.699 Q 100.64 24.264 99.84 25.494 Q 99.04 26.725 97.705 27.586 Q 96.369 28.447 94.69 28.895 Q 93.011 29.344 91.165 29.344 Z M 110.891 29.344 Q 108.272 29.344 106.409 28.315 Q 104.546 27.287 103.544 25.433 Q 102.542 23.578 102.542 21.082 Q 102.542 18.814 103.263 16.661 Q 103.983 14.508 105.389 12.794 Q 106.796 11.08 108.87 10.069 Q 110.944 9.059 113.669 9.059 Q 115.444 9.059 116.886 9.516 Q 118.327 9.973 119.373 10.834 Q 120.419 11.695 120.99 12.908 Q 121.561 14.121 121.597 15.633 L 116.587 16.477 Q 116.534 15.703 116.349 15.105 Q 116.165 14.508 115.805 14.077 Q 115.444 13.646 114.908 13.427 Q 114.372 13.207 113.616 13.207 Q 112.139 13.207 111.041 13.963 Q 109.942 14.719 109.239 15.932 Q 108.536 17.145 108.193 18.551 Q 107.85 19.957 107.85 21.24 Q 107.85 22.418 108.184 23.314 Q 108.518 24.211 109.23 24.703 Q 109.942 25.195 111.05 25.195 Q 111.841 25.195 112.561 24.949 Q 113.282 24.703 113.889 24.246 Q 114.495 23.789 114.97 23.147 Q 115.444 22.506 115.725 21.715 L 120.489 22.699 Q 119.962 24.246 119.056 25.468 Q 118.151 26.689 116.921 27.56 Q 115.69 28.43 114.17 28.887 Q 112.649 29.344 110.891 29.344 Z"></path>
					<path style="opacity: 1;" d="M 130.92 29.379 Q 128.301 29.379 126.403 28.421 Q 124.504 27.463 123.485 25.67 Q 122.465 23.877 122.465 21.363 Q 122.465 18.885 123.283 16.644 Q 124.1 14.402 125.612 12.68 Q 127.123 10.957 129.198 9.964 Q 131.272 8.971 133.768 8.971 Q 135.842 8.971 137.486 9.665 Q 139.129 10.359 140.078 11.634 Q 141.028 12.908 141.028 14.701 Q 141.028 16.529 139.955 17.716 Q 138.883 18.902 136.791 19.561 Q 134.7 20.221 131.641 20.484 Q 128.582 20.748 124.61 20.748 L 125.155 17.566 Q 128.512 17.566 130.665 17.452 Q 132.819 17.338 134.005 17.039 Q 135.192 16.74 135.658 16.239 Q 136.123 15.738 136.123 14.965 Q 136.123 14.033 135.341 13.488 Q 134.559 12.943 133.223 12.943 Q 131.5 12.943 130.393 13.84 Q 129.286 14.736 128.67 16.09 Q 128.055 17.443 127.8 18.894 Q 127.545 20.344 127.545 21.451 Q 127.545 22.576 127.888 23.473 Q 128.231 24.369 129.057 24.888 Q 129.883 25.406 131.307 25.406 Q 132.801 25.406 133.953 24.782 Q 135.104 24.158 135.614 23.051 L 140.342 23.684 Q 139.375 26.25 136.879 27.814 Q 134.383 29.379 130.92 29.379 Z M 149.071 17.742 L 147.208 28.957 L 141.934 28.957 L 145.204 9.305 L 150.161 9.305 L 149.475 14.209 L 149.106 14.033 Q 150.266 11.607 151.989 10.333 Q 153.712 9.059 156.102 9.059 Q 158.212 9.059 159.653 9.99 Q 161.094 10.922 161.692 12.627 Q 162.29 14.332 161.903 16.635 L 159.864 28.957 L 154.59 28.957 L 156.542 17.197 Q 156.858 15.352 156.067 14.411 Q 155.276 13.471 153.712 13.471 Q 152.534 13.471 151.558 13.998 Q 150.583 14.525 149.932 15.483 Q 149.282 16.441 149.071 17.742 Z M 172.076 29.379 Q 169.457 29.379 167.558 28.421 Q 165.66 27.463 164.64 25.67 Q 163.621 23.877 163.621 21.363 Q 163.621 18.885 164.438 16.644 Q 165.256 14.402 166.767 12.68 Q 168.279 10.957 170.353 9.964 Q 172.428 8.971 174.924 8.971 Q 176.998 8.971 178.641 9.665 Q 180.285 10.359 181.234 11.634 Q 182.183 12.908 182.183 14.701 Q 182.183 16.529 181.111 17.716 Q 180.039 18.902 177.947 19.561 Q 175.855 20.221 172.797 20.484 Q 169.738 20.748 165.765 20.748 L 166.31 17.566 Q 169.668 17.566 171.821 17.452 Q 173.974 17.338 175.161 17.039 Q 176.347 16.74 176.813 16.239 Q 177.279 15.738 177.279 14.965 Q 177.279 14.033 176.497 13.488 Q 175.715 12.943 174.379 12.943 Q 172.656 12.943 171.549 13.84 Q 170.441 14.736 169.826 16.09 Q 169.211 17.443 168.956 18.894 Q 168.701 20.344 168.701 21.451 Q 168.701 22.576 169.044 23.473 Q 169.387 24.369 170.213 24.888 Q 171.039 25.406 172.463 25.406 Q 173.957 25.406 175.108 24.782 Q 176.26 24.158 176.769 23.051 L 181.498 23.684 Q 180.531 26.25 178.035 27.814 Q 175.539 29.379 172.076 29.379 Z"></path>
					</g>
				</svg>
			</a>
		</div>

		<section id="signup">
			<form action="/signup" method="post" autocomplete="on">
				<input type="hidden" name="returnUrl" value="/" data-return-url />
				<input type="hidden" name="referrer_user_id" value="" data-referrer-user-id />
				<input type="hidden" name="referral_source" value="" data-referral-source />
				<input type="hidden" name="referral_image_id" value="" data-referral-image-id />
				<input type="hidden" name="referral_created_by_user_id" value="" data-referral-created-by-user-id />
				<label>
					Email
					<input type="email" name="username" autocomplete="username" inputmode="email" required />
				</label>
				<label>
					Password
					<input type="password" name="password" autocomplete="new-password" required />
				</label>
				<button type="submit">Create account</button>
			</form>
			<br />
			<p>Already have an account? <a href="#login">Login</a></p>
		</section>

		<section id="login">
			<div id="fail" class="alert error margin-bottom-1">
				<strong>Login failed</strong>
				<p>Please check your email and password, then try again.</p>
			</div>
			<form action="/login" method="post" autocomplete="on">
				<input type="hidden" name="returnUrl" value="/" data-return-url />
				<label>
					Email
					<input type="email" name="username" autocomplete="username" inputmode="email" required />
				</label>
				<label>
					Password
					<input type="password" name="password" autocomplete="current-password" required />
				</label>
				<button type="submit">Login</button>
			</form>
			<br />
			<p>Don't have an account? <a href="#signup">Signup</a></p>
		</section>

	</main>

	<script>
		(function () {
			try {
				var params = new URLSearchParams(window.location.search || '');
				var returnUrl = params.get('returnUrl');
				if (returnUrl) {
					// Basic client-side hardening; server still validates.
					if (typeof returnUrl === 'string') {
						returnUrl = returnUrl.trim();
						if (returnUrl.startsWith('/') && !returnUrl.startsWith('//') && returnUrl.indexOf('://') === -1 && returnUrl.length <= 2048) {
							var inputs = document.querySelectorAll('input[data-return-url][name="returnUrl"]');
							inputs.forEach(function (el) {
								el.value = returnUrl;
							});
						}
					}
				}
			} catch (e) {
				// ignore
			}

			// Referral capture from share pages (session-scoped)
			try {
				var raw = null;
				try { raw = sessionStorage.getItem('ps_referral'); } catch (e) { raw = null; }
				if (!raw) return;
				var ref = null;
				try { ref = JSON.parse(raw); } catch (e) { ref = null; }
				if (!ref || typeof ref !== 'object') return;

				var referrerId = Number(ref.referrer_user_id || 0);
				if (!Number.isFinite(referrerId) || referrerId <= 0) return;

				var elReferrer = document.querySelector('input[data-referrer-user-id][name="referrer_user_id"]');
				if (elReferrer) elReferrer.value = String(referrerId);

				var elSource = document.querySelector('input[data-referral-source][name="referral_source"]');
				if (elSource) elSource.value = String(ref.source || 'share');

				var imageId = Number(ref.image_id || 0);
				var elImage = document.querySelector('input[data-referral-image-id][name="referral_image_id"]');
				if (elImage && Number.isFinite(imageId) && imageId > 0) elImage.value = String(imageId);

				var createdBy = Number(ref.created_by_user_id || 0);
				var elCreatedBy = document.querySelector('input[data-referral-created-by-user-id][name="referral_created_by_user_id"]');
				if (elCreatedBy && Number.isFinite(createdBy) && createdBy > 0) elCreatedBy.value = String(createdBy);
			} catch (e) {
				// ignore
			}
		})();
	</script>

</body>

</html>